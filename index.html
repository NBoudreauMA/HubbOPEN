<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hubbardston Budget 2026 ðŸš€</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>


    <!-- Default Favicon -->
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/3/3f/Placeholder_view_vector.svg">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary: #2a7d2e;
            --secondary: #1e5b24;
            --accent: #ffd700;
            --text: #333;
            --background: #f8f9fa;
            --white: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
            --radius: 10px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--background);
            color: var(--text);
            margin: 0;
            padding: 0;
        }

        .navbar {
            background: var(--primary);
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 8px var(--shadow);
            border-bottom: 2px solid var(--accent);
        }

        .nav-links {
            list-style: none;
            display: flex;
            gap: 15px;
            margin: 0;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 8px 12px;
            transition: 0.3s;
            font-size: 0.9rem;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(rgba(30, 91, 36, 0.85), rgba(30, 91, 36, 0.85)), 
                        url('https://github.com/NBoudreauMA/Budget/blob/main/hubbardston_bg.jpg?raw=true') 
                        no-repeat center center;
            background-size: cover;
            color: white;
        }

        .section {
            max-width: 1200px;
            margin: 1.5rem auto;
            background: var(--white);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: 0 3px 6px var(--shadow);
        }

        .toggle-header {
            background: var(--primary);
            color: white;
            padding: 1rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: var(--radius);
            transition: 0.3s;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-header:hover {
            background: var(--secondary);
        }

        .toggle-content {
            display: none;
            padding: 1rem;
            animation: fadeIn 0.3s ease-in-out;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin: 20px 0;
        }

        .chart-box {
            position: relative;
            height: 300px;
            padding: 1rem;
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: 0 2px 6px var(--shadow);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem;
            border: 1px solid #eee;
            text-align: right;
        }

        .data-table th {
            background: var(--primary);
            color: white;
            text-align: left;
        }

        .data-table td:first-child {
            text-align: left;
        }

        .sub-toggle-header {
            background: #f0f9f0;
            color: var(--primary);
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            border: 1px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sub-toggle-content {
            display: none;
            padding: 1rem 0;
        }

        .highlights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .highlight-box {
            background: #f8f8f8;
            padding: 1.5rem;
            border-radius: var(--radius);
            border-left: 4px solid var(--primary);
        }

        .key-highlight-box {
            background: var(--primary);
            color: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            margin: 2rem 0;
        }

        .signature-block {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
        }

        .signature-content {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .ta-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid var(--primary);
        }

        footer {
            text-align: center;
            padding: 1rem;
            background: var(--primary);
            color: white;
            margin-top: 1.5rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-links {
                display: none;
            }

            .signature-content {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="logo">
            <img src="https://www.hubbardstonma.gov/sites/all/themes/custom/sites/hubbardstonma/vts_hubbardstonma/logo.png" alt="Hubbardston Seal" style="height: 30px;">
        </div>
        <ul class="nav-links">
            <li><a href="#message">TA Message</a></li>
            <li><a href="#revenue">Revenue</a></li>
            <li><a href="#expenditures">Expenditures</a></li>
            <li><a href="#capital">Capital Plan</a></li>
            <li><a href="#info">More Info</a></li>
        </ul>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <h1>FY26 Budget Proposal</h1>
        <p>Comprehensive overview of Hubbardston's financial plan and strategic investments for Fiscal Year 2026.</p>
    </header>

    <!-- TA Message -->
    <section class="section">
        <div class="toggle-header" onclick="toggleSection('message')">
            Town Administrator's Message
            <span class="toggle-icon">â–¼</span>
        </div>
        <div class="toggle-content" id="message">
            <div class="ta-header">
                <img src="https://www.hubbardstonma.gov/sites/all/themes/custom/sites/hubbardstonma/vts_hubbardstonma/logo.png" alt="Town Seal" class="ta-seal">
                <div class="ta-info">
                    <h2>Office of the Town Administrator</h2>
                    <p>2 Main Street, Unit 5</p>
                    <p>Hubbardston, MA 01452</p>
                </div>
            </div>
            
            <div class="message-content">
                <p class="date">February 21, 2025</p>
                <p class="greeting">Dear Residents of Hubbardston,</p>
                <p>I am pleased to present the Fiscal Year 2026 budget proposal for the Town of Hubbardston. This budget reflects our ongoing commitment to fiscal responsibility while investing in critical services and infrastructure that our community needs.</p>
                <!-- Add more message content -->
                <div class="signature-block">
                    <div class="signature-content">
                        <div class="signature-left">
                            <p>Sincerely,</p>
                            <p><strong>Nathan Boudreau, MPA, MCPPO</strong><br>Town Administrator</p>
                        </div>
                        <div class="signature-photo">
                            <img src="https://media.licdn.com/dms/image/v2/D4E03AQEW5_btYizZyg/profile-displayphoto-shrink_400_400/B4EZSZ4lygHcAk-/0/1737748537895?e=1745452800&v=beta&t=5n-BU2cpUF2VlMHcmw69kzWMcGz5nIyrg2lcLkX8_00" alt="Town Administrator" class="ta-photo">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Revenue Section -->
    <section class="section">
        <div class="toggle-header" onclick="toggleSection('revenue')">
            Revenue Overview
            <span class="toggle-icon">â–¼</span>
        </div>
        <div class="toggle-content" id="revenue">
            <p>Hubbardston's revenue sources include Tax Levy, State Aid, and Local Receipts.</p>
            
            <div class="chart-grid">
                <div class="chart-box">
                    <canvas id="revenueBarChart"></canvas>
                </div>
                <div class="chart-box">
                    <canvas id="revenuePieChart"></canvas>
                </div>
            </div>

            <table class="data-table">
                <tr>
                    <th>Account</th>
                    <th>FY23 Actual</th>
                    <th>FY24 Actual</th>
                    <th>FY25 Budget</th>
                    <th>FY26 Proposed</th>
                </tr>
                <tr>
                    <td>Tax Levy</td>
                    <td>$8,052,778</td>
                    <td>$8,425,343</td>
                    <td>$8,852,568</td>
                    <td>$9,276,259</td>
                </tr>
                <!-- Add other rows -->
            </table>
        </div>
    </section>

 <!-- Expenditure Section -->
<section class="section">
    <div class="toggle-header" onclick="toggleSection('expenditures')">
        Expenditure Overview 
        <span class="toggle-icon">â–¼</span>
    </div>
    <div class="toggle-content" id="expenditures">
        <p>Hubbardston's expenditures include General Government, Public Safety, Education, and Public Works.</p>
        <div class="chart-box">
            <canvas id="expenditureChart"></canvas>
        </div>
        <table class="data-table" id="expenditureTable">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>FY24 Actual</th>
                    <th>FY25 Requested</th>
                    <th>FY25 Actual</th>
                    <th>FY26 Dept</th>
                    <th>FY26 Admin</th>
                    <th>Change ($)</th>
                    <th>Change (%)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
    async function loadExpenditures() {
        try {
            // Use the correct file path
            const response = await fetch('expenditures_cleaned.csv');
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const csvText = await response.text();
            if (!csvText.trim()) {
                throw new Error("CSV file is empty or improperly formatted.");
            }
            const parsedData = Papa.parse(csvText, { header: true, skipEmptyLines: true });
            if (!parsedData.data.length) {
                throw new Error("CSV file has no valid rows.");
            }
            
            const labels = [];
            const fy24 = [], fy25_req = [], fy25_actual = [], fy26_dept = [], fy26_admin = [];
            const tableBody = document.querySelector('#expenditureTable tbody');
            tableBody.innerHTML = ""; // Clear any previous data

            for (const row of parsedData.data) {
                if (row.Category && row.FY24_Actual) {
                    labels.push(row.Category);
                    fy24.push(parseFloat(row.FY24_Actual.replace(/[$,]/g, '')) || 0);
                    fy25_req.push(parseFloat(row.FY25_Requested.replace(/[$,]/g, '')) || 0);
                    fy25_actual.push(parseFloat(row.FY25_Actual.replace(/[$,]/g, '')) || 0);
                    fy26_dept.push(parseFloat(row.FY26_Dept.replace(/[$,]/g, '')) || 0);
                    fy26_admin.push(parseFloat(row.FY26_Admin.replace(/[$,]/g, '')) || 0);
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${row.Category}</td>
                        <td>$${row.FY24_Actual}</td>
                        <td>$${row.FY25_Requested}</td>
                        <td>$${row.FY25_Actual}</td>
                        <td>$${row.FY26_Dept}</td>
                        <td>$${row.FY26_Admin}</td>
                        <td>${row.Change_Dollars || 'N/A'}</td>
                        <td>${row.Change_Percent || 'N/A'}</td>
                    `;
                    tableBody.appendChild(tr);
                }
            }
            
            new Chart(document.getElementById('expenditureChart').getContext('2d'), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'FY24 Actual', data: fy24, backgroundColor: '#2a7d2e' },
                        { label: 'FY25 Requested', data: fy25_req, backgroundColor: '#1e5b24' },
                        { label: 'FY25 Actual', data: fy25_actual, backgroundColor: '#34d399' },
                        { label: 'FY26 Dept', data: fy26_dept, backgroundColor: '#ffd700' },
                        { label: 'FY26 Admin', data: fy26_admin, backgroundColor: '#ff5733' }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            ticks: {
                                callback: value => `$${value.toLocaleString()}`  
                            }
                        }
                    }
                }
            });
        } catch (error) {
            console.error('Error loading expenditure data:', error);
        }
    }
    
    loadExpenditures();
</script>


    <!-- Capital Plan Section -->
    <section class="section">
        <div class="toggle-header" onclick="toggleSection('capital')">
            Capital Improvement Plan
            <span class="toggle-icon">â–¼</span>
        </div>
        <div class="toggle-content" id="capital">
            <div class="key-highlight-box">
                <h4>Public Safety Building Initiative</h4>
                <p>The Town will seek voter approval for a Proposition 2.5 override to fund a new consolidated Public Safety Building and Municipal Office Space at 48 Gardner Road.</p>
            </div>
            <!-- Add capital content -->
        </div>
    </section>

    <!-- More Info Section -->
    <section class="section">
        <div class="toggle-header" onclick="toggleSection('info')">
            More Information
            <span class="toggle-icon">â–¼</span>
        </div>
        <div class="toggle-content" id="info">
            <div class="sub-toggle-header" onclick="toggleSubSection('tax-info')">
                Where Your Tax Dollars Go
                <span class="toggle-icon">â–¼</span>
            </div>
            <div class="sub-toggle-content" id="tax-info">
                <!-- Add tax info content -->
            </div>

            <div class="sub-toggle-header" onclick="toggleSubSection('changes')">
                Year-Over-Year Changes
                <span class="toggle-icon">â–¼</span>
            </div>
            <div class="sub-toggle-content" id="changes">
                <!-- Add changes content -->
            </div>
        </div>
    </section>

    <footer>
        <p>Â© 2025 Town of Hubbardston - Budget Portal</p>
    </footer>

    <script>
        function toggleSection(id) {
            const content = document.getElementById(id);
            const header = content.previousElementSibling;
            const icon = header.querySelector('.toggle-icon');
            
            content.style.display = content.style.display === "block" ? "none" : "block";
            icon.textContent = content.style.display === "block" ? "â–¼" : "â–²";
            
            if (content.querySelector('canvas')) {
                window.dispatchEvent(new Event('resize'));
            }
        }

        function toggleSubSection(id) {
            const content = document.getElementById(id);
            const header = content.previousElementSibling;
            const icon = header.querySelector('.toggle-icon');
            
            content.style.display = content.style.display === "block" ? "none" : "block";
            icon.textContent = content.style.display === "block" ? "â–¼" : "â–²";
        }

        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Charts
            const createCharts = () => {
                try {
                    // Revenue Bar Chart
                    const revenueCtx = document.getElementById("revenueBarChart").getContext("2d");
                    new Chart(revenueCtx, {
                        type: "bar",
                        data: {
                            labels: ["Tax Levy", "State Aid", "Local Receipts"],
                            datasets: [{
                                label: "FY23 Actual",
                                data: [8052778, 668674, 1364392],
                                backgroundColor: "#2a7d2e"
                            }, {
                                label: "FY24 Actual",
                                data: [8425343, 682452, 1478687],
                                backgroundColor: "#1e5b24"
                            }, {
                                label: "FY25 Budget",
                                data: [8852568, 711871, 1502964],
                                backgroundColor: "#34d399"
                            }, {
                                label: "FY26 Proposed",
                                data: [9276259, 730906, 1619684],
                                backgroundColor: "#ffd700"
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Revenue Trends By Year'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label + ': $' + context.raw.toLocaleString();
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return '$' + value.toLocaleString();
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // Revenue Pie Chart
                    const revenuePieCtx = document.getElementById("revenuePieChart").getContext("2d");
                    new Chart(revenuePieCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Tax Levy', 'State Aid', 'Local Receipts'],
                            datasets: [{
                                data: [9276259, 730906, 1619684],
                                backgroundColor: [
                                    '#2a7d2e',
                                    '#1e5b24',
                                    '#34d399'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'FY26 Revenue Distribution'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const value = context.raw;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = ((value / total) * 100).toFixed(1);
                                            return `${context.label}: $${value.toLocaleString()} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // Add Expenditure Chart initialization here
                } catch (error) {
                    console.error("Error creating charts:", error);
                }
            };

            createCharts();
        });
    </script>
</body>
</html>
